(function(){'use strict';function g(a){console.log("LoaderBootstrap: [INFO] "+a)}function n(a){console.log("LoaderBootstrap: [WARN] "+a)}function q(a){console.error("LoaderBootstrap: [ERROR] "+a)}var r=null;
function u(){const a=[];for(var c=0;64>c;++c)a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(c)]=c;a[45]=62;a[95]=63;return function(b,d){var e=b.length-d;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");var f=b.indexOf("=",d);f=-1===f?e:f-d;e=[f,f===e?0:4-f%4];var l=e[0];e=e[1];f=new Uint8Array(3*(l+e)/4-e);var h=0;l=(0<e?l-4:l)+d;var k;for(k=d;k<l;k+=4)d=a[b.charCodeAt(k)]<<18|a[b.charCodeAt(k+1)]<<12|a[b.charCodeAt(k+2)]<<6|a[b.charCodeAt(k+
3)],f[h++]=d>>16&255,f[h++]=d>>8&255,f[h++]=d&255;2===e?(d=a[b.charCodeAt(k)]<<2|a[b.charCodeAt(k+1)]>>4,f[h++]=d&255):1===e&&(d=a[b.charCodeAt(k)]<<10|a[b.charCodeAt(k+1)]<<4|a[b.charCodeAt(k+2)]>>2,f[h++]=d>>8&255,f[h++]=d&255);return f.buffer}}function v(){return new Promise(function(a){setTimeout(a,20)})}
function w(a){return new Promise(function(c){const b=new Image;b.addEventListener("load",c);b.addEventListener("error",function(){n("Failed to preload image: "+a);c()});b.src=a;setTimeout(c,50)})}function x(a){return new Promise(function(c){fetch(a,{cache:"force-cache"}).then(function(b){return b.arrayBuffer()}).then(c).catch(function(b){q("Failed to fetch URL! "+b);c(null)})})}
function y(a){return a.startsWith("data:application/octet-stream;base64,")?new Promise(function(c){x(a).then(function(b){if(b)c(b);else{n("Failed to decode base64 via fetch, doing it the slow way instead...");try{r||=u();var d=r(a,37);c(d)}catch(e){q("Failed to decode base64! "+e),c(null)}}})}):x(a)}
function z(a,c){const b=document.createElement("h2");b.style.color="#AA0000";b.style.padding="25px";b.style.fontFamily="sans-serif";b.style.marginBlock="0px";b.appendChild(document.createTextNode(c));a.appendChild(b);c=document.createElement("h4");c.style.color="#AA0000";c.style.padding="25px";c.style.fontFamily="sans-serif";c.style.marginBlock="0px";c.appendChild(document.createTextNode("Try again later"));a.style.backgroundColor="white";a.appendChild(c)}
window.main=async function(){if("undefined"===typeof window.eaglercraftXOpts)q("window.eaglercraftXOpts is not defined!"),alert("window.eaglercraftXOpts is not defined!");else{var a=window.eaglercraftXOpts.container;if("string"!==typeof a)q("window.eaglercraftXOpts.container is not a string!"),alert("window.eaglercraftXOpts.container is not a string!");else{var c=window.eaglercraftXOpts.assetsURI;if("string"!==typeof c)if("object"===typeof c&&"object"===typeof c[0]&&"string"===typeof c[0].url)c=c[0].url;
else{q("window.eaglercraftXOpts.assetsURI is not a string!");alert("window.eaglercraftXOpts.assetsURI is not a string!");return}c.startsWith("data:")&&delete window.eaglercraftXOpts.assetsURI;var b=document.getElementById(a);if(b){for(;a=b.lastChild;)b.removeChild(a);a=document.createElement("div");a.style.width="100%";a.style.height="100%";a.style.setProperty("image-rendering","pixelated");a.style.background='center / contain no-repeat url("data:image/png;base64,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") white';
b.appendChild(a);await v();c.startsWith("data:")?(g('Downloading EPW file "<data: '+c.length+' chars>"...'),c=await y(c)):(g('Downloading EPW file "'+c+'"...'),c=await x(c));var d=!1;c?384>c.byteLength&&(q("The EPW file is too short"),d=!0):d=!0;if(d)b.removeChild(a),z(b,"Failed to download EPW file!"),q("Failed to download EPW file!");else{var e=new DataView(c);if(608649541!==e.getUint32(0,!0)||1297301847!==e.getUint32(4,!0))q("The file is not an EPW file"),d=!0;var f=c.byteLength;e.getUint32(8,
!0)!==f&&(q("The EPW file is the wrong length"),d=!0);if(d)b.removeChild(a),z(b,"EPW file is invalid!"),q("EPW file is invalid!");else{var l=new TextDecoder("utf-8"),h=e.getUint32(100,!0),k=e.getUint32(104,!0),m=e.getUint32(108,!0),p=e.getUint32(112,!0);if(0>h||h+k>f||0>m||m+p>f)q("The EPW file contains an invalid offset (component: splash)"),d=!0;if(d)b.removeChild(a),z(b,"EPW file is invalid!"),q("EPW file is invalid!");else{h=new Uint8Array(c,h,k);m=new Uint8Array(c,m,p);l=URL.createObjectURL(new Blob([h],
{type:l.decode(m)}));await w(l);g("Loaded splash img: "+l);a.style.background='center / contain no-repeat url("'+l+'"), 0px 0px / 1000000% 1000000% no-repeat url("'+l+'") white';await v();p=e.getUint32(164,!0);h=e.getUint32(168,!0);m=e.getUint32(180,!0);e=e.getUint32(184,!0);if(0>p||p+h>f||0>m||m+e>f)q("The EPW file contains an invalid offset (component: loader)"),d=!0;if(d)b.removeChild(a),z(b,"EPW file is invalid!"),q("EPW file is invalid!");else{a=new Uint8Array(c,p,h);a=URL.createObjectURL(new Blob([a],
{type:"text/javascript;charset=utf-8"}));g("Loaded loader.js: "+l);d=new Uint8Array(c,m,e);d=URL.createObjectURL(new Blob([d],{type:"application/wasm"}));g("Loaded loader.wasm: "+d);f={};for(const [t,A]of Object.entries(window.eaglercraftXOpts))"container"!==t&&"assetsURI"!==t&&(f[t]=A);window.__eaglercraftXLoaderContextPre={rootElement:b,eaglercraftXOpts:f,theEPWFileBuffer:c,loaderWASMURL:d,splashURL:l};g("Appending loader.js to document...");b=document.createElement("script");b.type="text/javascript";
b.src=a;document.head.appendChild(b)}}}}}else b='window.eaglercraftXOpts.container "'+a+'" is not a known element id!',q(b),alert(b)}}};}).call(this);
